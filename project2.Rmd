---
title: "Project 2"
author: "Craig Lazarski"
date: "October 15, 2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Libraries
```{r message=FALSE, warning=FALSE}
library("tidyverse")
library(GGally)

```
Read in and subset the data
```{r message=FALSE}
news <- read_csv("OnlineNewsPopularity.csv")

business <- news %>% filter(data_channel_is_bus == 1)
lifestyle <- news %>% filter(data_channel_is_lifestyle == 1)
entertainment <- news %>% filter(data_channel_is_entertainment == 1)
socmed <- news %>% filter(data_channel_is_socmed == 1)
tech <- news %>% filter(data_channel_is_tech == 1)
world <- news %>% filter(data_channel_is_world == 1)

# The sum of these rows does not equal the total number of rows in news.

# Check if there are unclassified observations
other <- news %>% filter((data_channel_is_lifestyle + data_channel_is_entertainment + data_channel_is_lifestyle + data_channel_is_bus + data_channel_is_socmed + data_channel_is_tech + data_channel_is_world) == 0)

# This accounts for all of the data. Life is good.
```
  
  Now that we had an excellent partitioning of the data.  By going to the website and reading the descriptions of the variables, we became interested to see if there was a time influence on the number of shares.  If an article was published on a week day versus a weekend, would it get more shares?  We thought so, with an intuition that people read more articles at work, and thus would be more likely to share articles that publish during the work week.  Let's see if we were on to something, shall we...  
    
    
```{r message=FALSE, warning=FALSE}

business <- business %>% mutate(day = 
            if_else(weekday_is_monday == 1, 'Monday', 
            if_else( weekday_is_tuesday == 1, 'Tuesday',
            if_else(weekday_is_wednesday == 1 , 'Wednesday', 
            if_else( weekday_is_thursday == 1 ,  'Thursday' ,
            if_else(weekday_is_friday == 1, 'Friday',
            if_else(weekday_is_saturday == 1, 'Saturday', 'Sunday')))))))

business$day <- factor(business$day, levels = c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"))
ggplot(data=business, aes(x=day, y=shares)) +
  geom_col()

```    
This graph indicates which day has the most shares. A higher bar indicates more shares on that day.

```{r}
business %>% group_by(day) %>% summarise(Total = sum(shares), mean = mean(shares), sd = sd(shares))
```
The summary statistics indicate the total number of shares per day along with the average and stanard deviation. Days with the highest mean indicate more shares. A large standard deviation indicates high variability in the number of shares on that day.


Things I think we should consider:



B) Multi media

```{R}
# Make a new variable combining images and videos
business <- business %>% mutate(multimedia = num_imgs + num_videos)
business <- business %>% mutate(multimedia_category = 
                                  if_else(multimedia >= 30, "high",
                                  if_else(multimedia >= 20, "medium", 
                                  if_else(multimedia >= 10, "low", "very low"))))
business$multimedia_category <- factor(business$multimedia_category, levels = c("very low", "low", "medium", "high"))

ggplot(data = business, aes(x= multimedia, y=shares)) +
  geom_point() +
  labs(x="Number of images and videos", y= "Shares", title = "Multimedia vs shares")
```
This graph displays the number of images and videos against the number of shares. A positive trend would indicate that more images and videos are associatied with more shares. A negative trend would indicate that more images and videos are associated with fewer shares.

```{r}
ggplot(data=business, aes(x=multimedia_category, y=shares)) +
  geom_col()

```
This graph displays the number of videos and images in a shared article. A high bar indicates the category that was most prevalent. 

C) How long is the article


11. n_tokens_content: Average length of the words in the content
With today's attention shortened attention span, are shorter articles more likely to be shared.

```{r}
# First, what is the distribution of article length?
plot(business$n_tokens_content)
summary(business$n_tokens_content)

# Looks like the vast majority are 1000 words or less.  So we'll break them into quantiles: Blip, Short, Medium, Epic

business <- business %>% mutate(wordiness = if_else(n_tokens_content > 727, 'Epic', if_else(n_tokens_content >539, 'Medium', if_else(n_tokens_content > 244, 'Short', 'Blip'))))

business$wordiness <- factor(business$wordiness, levels = c("Blip", "Short", "Medium", "Epic"))

g <- ggplot(data = business, aes(x = wordiness))

g + geom_bar(aes(fill = shares)) +
  labs(x="Wordiness", y= "Shares", title = "Wordiness vs shares")

  
```
This graph splits the length of the article by quartiles.  It shows that articles of 'Short' length are the most shared, followed by a tie of the two polar categories - the longest 'Epic' & the shortest 'Blip'


D) How long is the title?
Is the title one word or a phrase?  Does length perhaps grab the readers attention to read it and then to pass it on...let's look and see.

```{r}
# First, what is the distribution of title length?
plot(business$n_tokens_title)
summary(business$n_tokens_title)

# Good God!  A title 19 words long???  Isn't that a sentence and not a title???  Well, whatevers, grouping by quartiles:

business <- business %>% mutate(title_words = if_else(n_tokens_title > 12, 'Ridiculous', if_else(n_tokens_title > 10, 'Still_too_long', if_else(n_tokens_title > 9, 'Shorter', '3_words'))))

business$title_words <- factor(business$title_words, levels = c("3_words", "Shorter", "Still_too_long", "Ridiculous"))

g1 <- ggplot(data = business, aes(x = title_words))

g1 + geom_bar(aes(fill = shares)) +
  labs(x="Title Length", y= "Shares", title = "Title Length vs shares")


```
  
  
A title of three words seems to be best...just realized that if we are going to automate this to a function to read other categories, we need to call the different groupings by Q1, Q2, etc and not the individual values...sounds like a job for the AMAZING CRAIG!!  :)



E)  Is it a positive article, or negative?

```{r}
business <- business %>% mutate(av_avg_neg_polarity = -1*avg_negative_polarity)
ggplot(data=business, aes(x=av_avg_neg_polarity, y=avg_positive_polarity)) +
  geom_point() +
  stat_function(fun=function(x) x, size = 2, lty = 3 ,color = 'red')

```
This graph shows the relationship between the positive and negative polarity of an article. Values above the line y=x would indicate more positive and values below the line y=x indicate more negativity.


The graphs below the distribution of shares according to their positive and negative polarity rating. The peak of the distribution indicates what rating has the most shares.
```{r}
business <- business %>% mutate(pos_polarity_rating =  
                      if_else(avg_positive_polarity >= .9, "9",
                      if_else(avg_positive_polarity >= .8, "8",
                      if_else(avg_positive_polarity >= .7, "7",
                      if_else(avg_positive_polarity >= .6, "6",
                      if_else(avg_positive_polarity >= .5, "5",
                      if_else(avg_positive_polarity >= .4, "4",
                      if_else(avg_positive_polarity >= .3, "3",
                      if_else(avg_positive_polarity >= .2, "2",
                      if_else(avg_positive_polarity >= .1, "1", "0"))))))))))




ggplot(data=business, aes(x=pos_polarity_rating, y=shares)) +
  geom_col()

```


```{r}
business <- business %>% mutate(neg_polarity_rating =  
                      if_else(av_avg_neg_polarity >= .9, "9",
                      if_else(av_avg_neg_polarity >= .8, "8",
                      if_else(av_avg_neg_polarity >= .7, "7",
                      if_else(av_avg_neg_polarity >= .6, "6",
                      if_else(av_avg_neg_polarity >= .5, "5",
                      if_else(av_avg_neg_polarity >= .4, "4",
                      if_else(av_avg_neg_polarity >= .3, "3",
                      if_else(av_avg_neg_polarity >= .2, "2",
                      if_else(av_avg_neg_polarity >= .1, "1", "0"))))))))))


ggplot(data=business, aes(x=pos_polarity_rating, y=shares)) +
  geom_col()


```

```{r}
business <- business %>% mutate( sentiment = if_else(avg_positive_polarity > av_avg_neg_polarity, "positive", "negative"))

business %>% group_by(sentiment) %>% summarise(mean = mean(shares), sd= sd(shares))
```

This table compares the average number of shares based on positive and negative polarity of an article. If it is more positive than negative it is classified as positive, if not, negative. The summary statistics indicate the mean number of shares for articles classified as negative or positive and the standard deviation. A higher mean value would indicate more shares.
  
  
F) Is the title subjective?  Are shares lean towards opinion over objectiveness?  We would venture yes!

```{r}
plot(business$title_subjectivity)

head(business$title_subjectivity)

# Looks like the data is a ranking 0 to 1, and is continuous.  Scatterplot time! :)

g2 <- ggplot(business, aes(x = title_subjectivity, y = shares))
g2 + geom_point() 

```
   hmmmm...not seeing much here...maybe because it was business.  May make more of a difference in other categories...
   
```{r}
business <- business %>% mutate(subjectivity = if_else(title_subjectivity <=.3, "No Subjectivity", if_else(title_subjectivity <= .7, "Somewhat Subjective", "Very Subjective")))


ggplot(data=business, aes(x=subjectivity, y=shares)) +
  geom_col()

```
This graph shows how subjective a title was. If a title had a subjectivity rating below 0.3 it was classified as Not subjective, between 0.3 and 0.7 as somewhat subjective, and over 0.7 very subjective. A high bar in the very subjective column would indicate that the title subjectivity was hard to classify and may contribute to a higher missclassification rate.

46. global_rate_positive_words: Rate of positive words in the content
```{r}
plot(business$rate_positive_words, business$shares)
```
47. global_rate_negative_words: Rate of negative words in the content

```{r}
plot(business$global_rate_negative_words, business$shares)

```

