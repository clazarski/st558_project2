---
title: "Project 2"
author: "Craig Lazarski"
date: "October 15, 2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Libraries
```{r message=FALSE, warning=FALSE}
library("tidyverse")
library(GGally)

```
Read in and subset the data
```{r message=FALSE}
news <- read_csv("OnlineNewsPopularity.csv")

business <- news %>% filter(data_channel_is_bus == 1)
lifestyle <- news %>% filter(data_channel_is_lifestyle == 1)
entertainment <- news %>% filter(data_channel_is_entertainment == 1)
socmed <- news %>% filter(data_channel_is_socmed == 1)
tech <- news %>% filter(data_channel_is_tech == 1)
world <- news %>% filter(data_channel_is_world == 1)

# The sum of these rows does not equal the total number of rows in news.

# Check if there are unclassified observations
other <- news %>% filter((data_channel_is_lifestyle + data_channel_is_entertainment + data_channel_is_lifestyle + data_channel_is_bus + data_channel_is_socmed + data_channel_is_tech + data_channel_is_world) == 0)

# This accounts for all of the data. Life is good.
```
  
  Now that we had an excellent partitioning of the data.  By going to the website and reading the descriptions of the variables, we became interested to see if there was a time influence on the number of shares.  If an article was published on a week day versus a weekend, would it get more shares?  We thought so, with an intuition that people read more articles at work, and thus would be more likely to share articles that publish during the work week.  Let's see if we were on to something, shall we...  
    
    
```{r message=FALSE, warning=FALSE}

business <- business %>% mutate(day = 
            if_else(weekday_is_monday == 1, 'Monday', 
            if_else( weekday_is_tuesday == 1, 'Tuesday',
            if_else(weekday_is_wednesday == 1 , 'Wednesday', 
            if_else( weekday_is_thursday == 1 ,  'Thursday' ,
            if_else(weekday_is_friday == 1, 'Friday',
            if_else(weekday_is_saturday == 1, 'Saturday', 'Sunday')))))))

business$day <- factor(business$day, levels = c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"))
ggplot(data=business, aes(x=day, y=shares)) +
  geom_col()

```    
This graph indicates which day has the most shares. A higher bar indicates more shares on that day.

```{r}
business %>% group_by(day) %>% summarise(Total = sum(shares), mean = mean(shares), sd = sd(shares))
```
The summary statistics indicate the total number of shares per day along with the average and stanard deviation. Days with the highest mean indicate more shares. A large standard deviation indicates high variability in the number of shares on that day.


Things I think we should consider:



B) Multi media

```{R}
# Make a new variable combining images and videos
business <- business %>% mutate(multimedia = num_imgs + num_videos)

ggplot(data = business, aes(x= multimedia, y=shares)) +
  geom_point() +
  labs(x="Number of images and videos", y= "Shares", title = "Multimedia vs shares")
```
This graph displays the number of images and videos against the number of shares. A positive trend would indicate that more images and videos are associatied with more shares. A negative trend would indicate that more images and videos are associated with fewer shares.


C) How long is the article


11. average_token_length: Average length of the words in the content



E)  Is it a positive article, or negative?

```{r}
business <- business %>% mutate(av_avg_neg_polarity = -1*avg_negative_polarity)
ggplot(data=business, aes(x=av_avg_neg_polarity, y=avg_positive_polarity)) +
  geom_point() +
  stat_function(fun=function(x) x, size = 2, lty = 3 ,color = 'red')

```
This graph shows the relationship between the positivey and negative polarity of an article. Values above the line y=x would indicate more positive and values below the line y=x indicate more negativity.

```{r}
ggplot(data=business, aes(x=avg_positive_polarity, y=shares)) +
  geom_point() +
  labs(x="Average Positive Polarity", y= "Shares", title = "Positive polarity vs shares")
```
The graph shows the average positive polarity rating vesus the number of shares. A positive trend indicates that a higher average positive polarity is associated with more shares. A negative trend indicates that a higher average positive polarity is associated with less shares.

```{r}
ggplot(data=business, aes(x=av_avg_neg_polarity, y=shares)) +
  geom_point() +
  labs(x="Absolute Value Average Negative Polarity", y= "Shares", title = "Negative polarity vs shares")
```
The graph shows the absolute value average negative polarity rating vesus the number of shares. A positive trend indicates that a higher absolute value average negative polarity is associated with more shares. A negative trend indicates that a higher absolute value average positive polarity is associated with less shares.

```{r}
business <- business %>% mutate( sentiment = if_else(avg_positive_polarity > av_avg_neg_polarity, "positive", "negative"))

business %>% group_by(sentiment) %>% summarise(mean = mean(shares), sd= sd(shares))
```

This table compares the average positive and negative polarity of an article. If it is more positive than negative it is classified as positive, if not, negative. The summary statistics indicate the mean number of shares for articles classified as negative or positive and the standard deviation. A higher mean value would indicate more shares.
46. global_rate_positive_words: Rate of positive words in the content
```{r}
plot(business$rate_positive_words, business$shares)
```
47. global_rate_negative_words: Rate of negative words in the content

```{r}
plot(business$global_rate_negative_words, business$shares)

```
```{r message=FALSE, warning=FALSE}

plot(news)
head(business)

```
