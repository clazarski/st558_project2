---
title: "Project 2"
author: "Craig Lazarski"
date: "October 15, 2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Libraries
```{r message=FALSE, warning=FALSE}
library("tidyverse")
library(GGally)
set.seed(1234)
```
Read in and subset the data
```{r message=FALSE}
news <- read_csv("OnlineNewsPopularity.csv")

business <- news %>% filter(data_channel_is_bus == 1)
lifestyle <- news %>% filter(data_channel_is_lifestyle == 1)
entertainment <- news %>% filter(data_channel_is_entertainment == 1)
socmed <- news %>% filter(data_channel_is_socmed == 1)
tech <- news %>% filter(data_channel_is_tech == 1)
world <- news %>% filter(data_channel_is_world == 1)

# The sum of these rows does not equal the total number of rows in news.

# Check if there are unclassified observations
other <- news %>% filter((data_channel_is_lifestyle + data_channel_is_entertainment + data_channel_is_lifestyle + data_channel_is_bus + data_channel_is_socmed + data_channel_is_tech + data_channel_is_world) == 0)

# This accounts for all of the data. Life is good.
```
  
  Now that we had an excellent partitioning of the data.  By going to the website and reading the descriptions of the variables, we became interested to see if there was a time influence on the number of shares.  If an article was published on a week day versus a weekend, would it get more shares?  We thought so, with an intuition that people read more articles at work, and thus would be more likely to share articles that publish during the work week.  Let's see if we were on to something, shall we...  
    
    
```{r message=FALSE, warning=FALSE}

business <- business %>% mutate(day = 
            if_else(weekday_is_monday == 1, 'Monday', 
            if_else( weekday_is_tuesday == 1, 'Tuesday',
            if_else(weekday_is_wednesday == 1 , 'Wednesday', 
            if_else( weekday_is_thursday == 1 ,  'Thursday' ,
            if_else(weekday_is_friday == 1, 'Friday',
            if_else(weekday_is_saturday == 1, 'Saturday', 'Sunday')))))))

business$day <- factor(business$day, levels = c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"))
ggplot(data=business, aes(x=day, y=shares)) +
  geom_col()

```    
This graph indicates which day has the most shares. A higher bar indicates more shares on that day.

```{r}
business %>% group_by(day) %>% summarise(Total = sum(shares), mean = mean(shares), sd = sd(shares))
```
The summary statistics indicate the total number of shares per day along with the average and stanard deviation. Days with the highest mean indicate more shares. A large standard deviation indicates high variability in the number of shares on that day.

Multi media

```{R}
# Make a new variable combining images and videos
business <- business %>% mutate(multimedia = num_imgs + num_videos)
business <- business %>% mutate(multimedia_category = 
                                  if_else(multimedia >= 30, "high",
                                  if_else(multimedia >= 20, "medium", 
                                  if_else(multimedia >= 10, "low", "very low"))))
business$multimedia_category <- factor(business$multimedia_category, levels = c("very low", "low", "medium", "high"))

ggplot(data = business, aes(x= multimedia, y=shares)) +
  geom_point() +
  labs(x="Number of images and videos", y= "Shares", title = "Multimedia vs shares")
```
This graph displays the number of images and videos against the number of shares. A positive trend would indicate that more images and videos are associatied with more shares. A negative trend would indicate that more images and videos are associated with fewer shares.

```{r}
ggplot(data=business, aes(x=multimedia_category, y=shares)) +
  geom_col()

```
This graph displays the number of videos and images in a shared article. A high bar indicates the category that was most prevalent. 

How long is the article

With today's shortened attention span, are shorter articles more likely to be shared?

```{r}
# First, what is the distribution of article length?
plot(business$n_tokens_content)
results <- summary(news$n_tokens_content)

# Looks like the vast majority are 1000 words or less.  So we'll break them into quantiles: Blip, Short, Medium, Epic

business <- business %>% mutate(wordiness = if_else(n_tokens_content > results[[5]], 'Epic', if_else(n_tokens_content >results[[3]], 'Medium', if_else(n_tokens_content > results[[2]], 'Short', 'Blip'))))

business$wordiness <- factor(business$wordiness, levels = c("Blip", "Short", "Medium", "Epic"))

ggplot(data = business, aes(x = wordiness, y=shares)) +
  geom_col() +
  labs(x="Wordiness", y= "Shares", title = "Wordiness vs shares")

# Summary of wordiness

business %>% group_by(wordiness) %>% summarise(Total = sum(shares), mean = mean(shares), sd = sd(shares))


```
The category with the highest bar indicates which grouping of lengths was most shared for this category of articles.

The summary statistics show the total number of shares based on article length.  It also reports the average and the standard deviation.  If the standard deviation is high, then it says there's much more variation in the number of shares. 


How long is the title?
Is the title one word or a phrase?  Does length perhaps grab the readers attention to read it and then to pass it on...let's look and see.

```{r}
# First, what is the distribution of title length?
plot(business$n_tokens_title)
results <- summary(news$n_tokens_title)
results
# Good God!  A title 23 words long???  Isn't that a sentence and not a title???  Well, whatevers, grouping by quartiles:

business <- business %>% mutate(title_words = if_else(n_tokens_title > results[[5]] , 'Long', if_else(n_tokens_title > results[[3]], 'Typical', 'Short')))

results[[5]]
business$title_words <- factor(business$title_words, levels = c("Short", "Typical", "Long"))

ggplot(data = business, aes(x = title_words, y = shares)) + 
  geom_col() +
  labs(x="Title Length", y= "Shares", title = "Title Length vs shares")


```
The category with the highest bar indicates the length that is most shared.  

Would a long article have a long title?  Is there a relationship between article length and title length?  If so, there might be an issue of correlation.

```{r message=FALSE, warning=FALSE}

table(business$wordiness, business$title_words)

```

Is it a positive article, or negative?

This table compares the average number of shares based on positive and negative polarity of an article. If it is more positive than negative it is classified as positive, if not, negative. The summary statistics indicate the mean number of shares for articles classified as negative or positive and the standard deviation. A higher mean value would indicate more shares.

```{r}
business <- business %>% mutate(av_avg_neg_polarity = -1*avg_negative_polarity)
ggplot(data=business, aes(x=av_avg_neg_polarity, y=avg_positive_polarity)) +
  geom_point() +
  stat_function(fun=function(x) x, size = 2, lty = 3 ,color = 'red')

```
This graph shows the relationship between the positive and negative polarity of an article. Values above the line y=x would indicate more positive and values below the line y=x indicate more negativity.


The graphs below the distribution of shares according to their positive and negative polarity rating. The peak of the distribution indicates what rating has the most shares.



```{r}
business <- business %>% mutate( sentiment = if_else(avg_positive_polarity > av_avg_neg_polarity, "positive", "negative"))

business %>% group_by(sentiment) %>% summarise(mean = mean(shares), sd= sd(shares), sum = sum(shares), ratio = sum(shares))
summary(news$shares)

business2 <- business %>% subset(shares >= 2800) 

ggplot(data = business2, aes(x=sentiment, y=shares)) +
  geom_col()
```
This graph took the 25% of articles with the most shares and display the shares based on their positivity or negativity. The higher bar will indicate what the most shared articles can be categorized as that sentiment.


Is the title subjective?  Do shares lean towards opinion over objectiveness?  We would venture yes!

```{r}
plot(business$title_subjectivity)

head(business$title_subjectivity)

# Looks like the data is a ranking 0 to 1, and is continuous.  Scatterplot time! :)

g2 <- ggplot(business, aes(x = title_subjectivity, y = shares))
g2 + geom_point() 

```
   hmmmm...not seeing much here...maybe because it was business.  May make more of a difference in other categories...
   
```{r}
business <- business %>% mutate(subjectivity = if_else(title_subjectivity <=.3, "No Subjectivity", if_else(title_subjectivity <= .7, "Somewhat Subjective", "Very Subjective")))


ggplot(data=business2, aes(x=subjectivity, y=shares)) +
  geom_col()

```
If a title had a subjectivity rating below 0.3 it was classified as Not subjective, between 0.3 and 0.7 as somewhat subjective, and over 0.7 very subjective. THe highest bar in any column would indicate that the most shared articles have a subjectivity of that bars rating.  A high bar in the very subjective column would indicate that the title subjectivity was hard to classify and may contribute to a higher missclassification rate.




A linear model is about fitting your mom ...
After I pee my rsqured is much lower. 

Linear Models
```{R}
# Linear model involving only emotional variables

Model1 <- lm(shares ~  avg_positive_polarity + avg_negative_polarity + global_sentiment_polarity  + rate_positive_words + rate_negative_words + title_sentiment_polarity, data = business)

# Linear model involving physical attributes of article
Model2 <- lm( shares ~ num_imgs + num_videos + num_keywords + n_tokens_title + n_tokens_content, data = business)

Model3 <- lm( shares ~ num_imgs + num_videos , data = business )


summary(Model1)
summary(Model3)
```